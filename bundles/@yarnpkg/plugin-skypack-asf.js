/* eslint-disable */
module.exports = {
name: "@yarnpkg/plugin-skypack-asf",
factory: function (require) {
var plugin;plugin=(()=>{"use strict";var e={145:(e,t,r)=>{r.r(t),r.d(t,{default:()=>u});const n=require("@yarnpkg/core"),s=require("semver");var o=r.n(s);const a="skypack:",i="https://cdn.skypack.dev",c="https://api.skypack.dev";function l(e){return`/${e.scope?`@${e.scope}/`:""}${e.name}`}const p=require("@yarnpkg/fslib");const u={fetchers:[class{supports(e,t){return e.reference.startsWith(a)}getLocalPath(e,t){return null}async fetch(e,t){const r=t.checksums.get(e.locatorHash)||null,[s,o,a]=await t.cache.fetchPackageFromCache(e,r,{onHit:()=>t.report.reportCacheHit(e),onMiss:()=>t.report.reportCacheMiss(e,n.structUtils.prettyLocator(t.project.configuration,e)+" can't be found in the cache and will be generated from Skypack"),loader:()=>this.generate(e,t),skipIntegrityCheck:t.skipIntegrityCheck});return{packageFs:s,releaseFs:o,prefixPath:n.structUtils.getIdentVendorPath(e),checksum:a}}async generate(e,t){const{selector:r}=n.structUtils.parseRange(e.reference),s=o().clean(r);if(null===s)throw new n.ReportError(n.MessageName.RESOLVER_NOT_FOUND,"The Skypack semver resolver got selected, but the version isn't semver");let a;const u=`${c}/v1/package${l(e)}`;try{a=await n.httpUtils.get(u,{jsonResponse:!0,configuration:t.project.configuration})}catch(e){throw new n.ReportError(n.MessageName.FETCH_FAILED,"Couldn't lookup package data from "+u)}const g=a.exportMap||{".":"./index.js"},d="string"==typeof g?{".":g}:g,f=`${i}${l(e)}@${s}`;t.report.reportInfo(n.MessageName.UNNAMED,"Import url: "+f);const h=await n.httpUtils.request(f,null,{configuration:t.project.configuration});if(200!==h.statusCode)throw new n.ReportError(n.MessageName.FETCH_FAILED,`${f} responded with code ${h.statusCode}`);const m=h.headers["x-pinned-url"];m||t.report.reportWarning(n.MessageName.UNNAMED,n.structUtils.prettyLocator(t.project.configuration,e)+" has no pinned URL available; falling back to lookup URL");const y=m?`${i}${m}`:f;t.report.reportInfo(n.MessageName.UNNAMED,"full url: "+y);const v=function e(t,r){if("string"==typeof t)return[{filePath:t,urlPath:r}];const n=Object.keys(t).filter(e=>!e.includes("*"));if(n.every(e=>e.startsWith(".")))return n.flatMap(n=>e(t[n],r+n.slice(1)));{const n=[t.browser,t.import,t.node,t.default].filter(Boolean);if(!n.length)throw new Error("No matching condition found from "+Object.keys(t));return n.flatMap(t=>e(t,r))}}(d,"");return p.xfs.mktempPromise(async r=>(await Promise.all(v.map(({filePath:e,urlPath:t})=>p.xfs.writeFilePromise(p.ppath.join(r,e),`export * from "${y+t}";\n`))),await p.xfs.writeJsonPromise(p.ppath.join(r,"package.json"),{name:e.name,version:s,type:"module",description:a.description,license:a.license,main:"index.js",module:"index.js",exports:a.exportMap}),n.tgzUtils.makeArchiveFromDirectory(r,{prefixPath:n.structUtils.getIdentVendorPath(e),compressionLevel:t.project.configuration.get("compressionLevel")})))}}],resolvers:[class{supportsDescriptor(e,t){return!!e.range.startsWith(a)&&!!n.semverUtils.validRange(e.range.slice(a.length))}supportsLocator(e,t){if(!e.reference.startsWith(a))return!1;const{selector:r}=n.structUtils.parseRange(e.reference);return!!o().valid(r)}shouldPersistResolution(e,t){return!0}bindDescriptor(e,t,r){return e}getResolutionDependencies(e,t){return[]}async getCandidates(e,t,r){const s=n.semverUtils.validRange(e.range.slice(a.length));if(null===s)throw new Error("Expected a valid range, got "+e.range.slice(a.length));const i=await n.httpUtils.get(`${c}/v1/package${l(e)}`,{jsonResponse:!0,configuration:r.project.configuration});return i.isDeprecated&&r.report.reportWarning(n.MessageName.DEPRECATED_PACKAGE,n.structUtils.prettyDescriptor(r.project.configuration,e)+" is deprecated"),Object.keys(i.versions).map(e=>new(o().SemVer)(e)).filter(e=>s.test(e)).sort((e,t)=>-e.compare(t)).map(t=>n.structUtils.makeLocator(e,`${a}${t.raw}`))}async getSatisfying(e,t,r){const s=n.semverUtils.validRange(e.range.slice(a.length));if(null===s)throw new Error("Expected a valid range, got "+e.range.slice(a.length));return t.map(e=>{try{return new(o().SemVer)(e.slice(a.length))}catch(e){return null}}).filter(e=>null!==e).filter(e=>s.test(e)).sort((e,t)=>-e.compare(t)).map(t=>n.structUtils.makeLocator(e,`${a}${t.raw}`))}async resolve(e,t){const{selector:r}=n.structUtils.parseRange(e.reference),s=o().clean(r);if(null===s)throw new n.ReportError(n.MessageName.RESOLVER_NOT_FOUND,"The Skypack semver resolver got selected, but the version isn't semver");return{...e,version:s,languageName:"node",linkType:n.LinkType.HARD,dependencies:new Map,peerDependencies:new Map,dependenciesMeta:new Map,peerDependenciesMeta:new Map,bin:new Map}}}]}}},t={};function r(n){if(t[n])return t[n].exports;var s=t[n]={exports:{}};return e[n](s,s.exports,r),s.exports}return r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r(145)})();
return plugin;
}
};